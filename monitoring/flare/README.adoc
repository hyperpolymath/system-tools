#!/usr/bin/env bash

# Create directory hierarchy
mkdir -p config docs scripts/shells src/monitor src/optimize

# 1. The Fixed Architecture Doc (Ensuring it doesn't compress)
cat << 'EOF' > docs/architecture.adoc
= System Flare: Architecture
:revdate: 2026-01-07

[literal]
....
system-flare/
├── .asdf/                # Version management
├── config/
│   └── flare.ncl         # Nickel configuration (The 'Must')
├── cookbook.adoc         # Recipes for Just (The 'Just')
├── docs/
│   ├── BSL_GUIDE.adoc    # British Sign Language support docs
│   └── architecture.adoc # Formal design specs
├── scripts/
│   └── shells.file       # Multimodal shell reference
├── src/
│   ├── monitor/          # Observation logic (The 'Observer')
│   ├── optimize/         # High-priority stop logic (The 'Optimizer')
│   └── main.v            # Entry point in V
├── README.md             # Primary documentation (Bash centric)
└── LICENSE               # PMPL-1.0-or-later
....

== Design Philosophy
System Flare is designed to approach the physical limit of a system stop. 
By utilising V, we bypass the overhead of heavy runtimes (JVM/Node/Python).
EOF

# 2. The Multi-Shell Reference File (All 17 Shells)
cat << 'EOF' > scripts/shells.file
# SYSTEM FLARE MULTIMODAL SHELL WRAPPERS
# This file contains implementations for:
# bash, cmd, oil, ash, csh, dash, elvish, fish, ion, ksh, murex, ngs, nushell, powershell-core, tcsh, tsh, zsh, and minix shell.

--- BASH ---
#!/usr/bin/env bash
./system-flare "$@"

--- FISH ---
#!/usr/bin/fish
./system-flare $argv

--- NUSHELL ---
#!/usr/bin/nu
def main [...args] { ./system-flare $args }

--- CMD (Windows) ---
@echo off
system-flare.exe %*

--- POWERSHELL ---
./system-flare.exe $args

[... Remaining 12 shells omitted for brevity in this cat block, but paths reserved ...]
EOF

# 3. Nickel Logic (The 'Must')
cat << 'EOF' > config/flare.ncl
{
  project = "SystemFlare",
  optimisations = {
    bypass_init = true,
    parallel_sync = true,
  },
  monitoring = {
    precision = "nanoseconds",
    endpoint = "127.0.0.1:9001",
  }
}
EOF

# 4. The Man Page (Standard documentation)
cat << 'EOF' > docs/flare.1
.TH FLARE 1 "2026-01-07" "1.0" "System Flare Manual"
.SH NAME
flare \- Absolute system stop and monitoring framework
.SH SYNOPSIS
.B flare
[\fIOPTION\fR]...
.SH DESCRIPTION
Optimises the path to a physical halt while preserving state-in-progress.
EOF

echo "System Flare Rhodium Repository initialised. Check docs/architecture.adoc for the fix."
